/**
 * SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.
 * Copyright (C) 2021 SalesAgility Ltd.
 *
 * This program is free software; you can redistribute it and/or modify it under
 * the terms of the GNU Affero General Public License version 3 as published by the
 * Free Software Foundation with the addition of the following permission added
 * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK
 * IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE
 * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more
 * details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * In accordance with Section 7(b) of the GNU Affero General Public License
 * version 3, these Appropriate Legal Notices must retain the display of the
 * "Supercharged by SuiteCRM" logo. If the display of the logos is not reasonably
 * feasible for technical reasons, the Appropriate Legal Notices must display
 * the words "Supercharged by SuiteCRM".
 */
import { BehaviorSubject } from 'rxjs';
import { signal } from "@angular/core";
export class BaseField {
    constructor() {
        this.loading = signal(false);
        this.fieldDependencies = {};
        this.attributeDependencies = [];
        this.defaultValueInitialized = false;
        this.valueSubject = new BehaviorSubject({});
        this.valueChanges$ = this.valueSubject.asObservable();
        this.display = signal('default');
        this.required = signal(false);
    }
    get value() {
        return this.valueState;
    }
    set value(value) {
        const changed = value !== this.valueState;
        this.valueState = value;
        if (changed) {
            this.emitValueChanges();
        }
    }
    get valueList() {
        return this.valueListState;
    }
    set valueList(value) {
        this.valueListState = value;
        this.emitValueChanges();
    }
    get valueObject() {
        return this.valueObjectState;
    }
    set valueObject(value) {
        this.valueObjectState = value;
        this.emitValueChanges();
    }
    get valueObjectArray() {
        return this.valueObjectArrayState;
    }
    set valueObjectArray(value) {
        this.valueObjectArrayState = value;
        this.emitValueChanges();
    }
    emitValueChanges() {
        this.valueSubject.next({
            value: this.valueState,
            valueList: this.valueListState,
            valueObject: this.valueObjectState
        });
    }
    initDefaultValue() {
        if (this.defaultValueInitialized) {
            return;
        }
        const defaultValue = this?.default ?? this?.definition?.default ?? null;
        if (!this.value && defaultValue) {
            this.value = defaultValue;
            this?.formControl?.setValue(defaultValue);
            this.defaultValueInitialized = true;
        }
        else if (this.value === null) {
            this.value = '';
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmllbGQubW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9jb3JlL2FwcC9jb3JlL3NyYy9saWIvY29tbW9uL3JlY29yZC9maWVsZC5tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBd0JHO0FBR0gsT0FBTyxFQUFDLGVBQWUsRUFBYSxNQUFNLE1BQU0sQ0FBQztBQU1qRCxPQUFPLEVBQUMsTUFBTSxFQUFpQixNQUFNLGVBQWUsQ0FBQztBQW1MckQsTUFBTSxPQUFPLFNBQVM7SUFzQ2xCO1FBaENBLFlBQU8sR0FBNkIsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBb0JsRCxzQkFBaUIsR0FBYyxFQUFFLENBQUM7UUFDbEMsMEJBQXFCLEdBQTBCLEVBQUUsQ0FBQztRQVNsRCw0QkFBdUIsR0FBWSxLQUFLLENBQUM7UUFHckMsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLGVBQWUsQ0FBYSxFQUFnQixDQUFDLENBQUM7UUFDdEUsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQ3RELElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxJQUFJLEtBQUs7UUFDTCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDM0IsQ0FBQztJQUVELElBQUksS0FBSyxDQUFDLEtBQWE7UUFDbkIsTUFBTSxPQUFPLEdBQUcsS0FBSyxLQUFLLElBQUksQ0FBQyxVQUFVLENBQUM7UUFFMUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFFeEIsSUFBSSxPQUFPLEVBQUUsQ0FBQztZQUNWLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQzVCLENBQUM7SUFDTCxDQUFDO0lBRUQsSUFBSSxTQUFTO1FBQ1QsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQy9CLENBQUM7SUFFRCxJQUFJLFNBQVMsQ0FBQyxLQUFlO1FBRXpCLElBQUksQ0FBQyxjQUFjLEdBQUcsS0FBSyxDQUFDO1FBRTVCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFJLFdBQVc7UUFDWCxPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQztJQUNqQyxDQUFDO0lBRUQsSUFBSSxXQUFXLENBQUMsS0FBVTtRQUN0QixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsS0FBSyxDQUFDO1FBQzlCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFJLGdCQUFnQjtRQUNoQixPQUFPLElBQUksQ0FBQyxxQkFBcUIsQ0FBQztJQUN0QyxDQUFDO0lBRUQsSUFBSSxnQkFBZ0IsQ0FBQyxLQUFrQjtRQUNuQyxJQUFJLENBQUMscUJBQXFCLEdBQUcsS0FBSyxDQUFDO1FBQ25DLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFUyxnQkFBZ0I7UUFDdEIsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUM7WUFDbkIsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQ3RCLFNBQVMsRUFBRSxJQUFJLENBQUMsY0FBYztZQUM5QixXQUFXLEVBQUUsSUFBSSxDQUFDLGdCQUFnQjtTQUNyQyxDQUFDLENBQUE7SUFDTixDQUFDO0lBRUQsZ0JBQWdCO1FBRVosSUFBSSxJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQztZQUMvQixPQUFPO1FBQ1gsQ0FBQztRQUVELE1BQU0sWUFBWSxHQUFHLElBQUksRUFBRSxPQUFPLElBQUksSUFBSSxFQUFFLFVBQVUsRUFBRSxPQUFPLElBQUksSUFBSSxDQUFDO1FBQ3hFLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLFlBQVksRUFBRSxDQUFDO1lBQzlCLElBQUksQ0FBQyxLQUFLLEdBQUcsWUFBWSxDQUFDO1lBQzFCLElBQUksRUFBRSxXQUFXLEVBQUUsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQzFDLElBQUksQ0FBQyx1QkFBdUIsR0FBRyxJQUFJLENBQUM7UUFDeEMsQ0FBQzthQUFNLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxJQUFJLEVBQUUsQ0FBQztZQUM3QixJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztRQUNwQixDQUFDO0lBQ0wsQ0FBQztDQUVKIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTdWl0ZUNSTSBpcyBhIGN1c3RvbWVyIHJlbGF0aW9uc2hpcCBtYW5hZ2VtZW50IHByb2dyYW0gZGV2ZWxvcGVkIGJ5IFNhbGVzQWdpbGl0eSBMdGQuXG4gKiBDb3B5cmlnaHQgKEMpIDIwMjEgU2FsZXNBZ2lsaXR5IEx0ZC5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdCB1bmRlclxuICogdGhlIHRlcm1zIG9mIHRoZSBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbiAzIGFzIHB1Ymxpc2hlZCBieSB0aGVcbiAqIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiB3aXRoIHRoZSBhZGRpdGlvbiBvZiB0aGUgZm9sbG93aW5nIHBlcm1pc3Npb24gYWRkZWRcbiAqIHRvIFNlY3Rpb24gMTUgYXMgcGVybWl0dGVkIGluIFNlY3Rpb24gNyhhKTogRk9SIEFOWSBQQVJUIE9GIFRIRSBDT1ZFUkVEIFdPUktcbiAqIElOIFdISUNIIFRIRSBDT1BZUklHSFQgSVMgT1dORUQgQlkgU0FMRVNBR0lMSVRZLCBTQUxFU0FHSUxJVFkgRElTQ0xBSU1TIFRIRVxuICogV0FSUkFOVFkgT0YgTk9OIElORlJJTkdFTUVOVCBPRiBUSElSRCBQQVJUWSBSSUdIVFMuXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUXG4gKiBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTU1xuICogRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIEdOVSBBZmZlcm8gR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZVxuICogZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LlxuICpcbiAqIEluIGFjY29yZGFuY2Ugd2l0aCBTZWN0aW9uIDcoYikgb2YgdGhlIEdOVSBBZmZlcm8gR2VuZXJhbCBQdWJsaWMgTGljZW5zZVxuICogdmVyc2lvbiAzLCB0aGVzZSBBcHByb3ByaWF0ZSBMZWdhbCBOb3RpY2VzIG11c3QgcmV0YWluIHRoZSBkaXNwbGF5IG9mIHRoZVxuICogXCJTdXBlcmNoYXJnZWQgYnkgU3VpdGVDUk1cIiBsb2dvLiBJZiB0aGUgZGlzcGxheSBvZiB0aGUgbG9nb3MgaXMgbm90IHJlYXNvbmFibHlcbiAqIGZlYXNpYmxlIGZvciB0ZWNobmljYWwgcmVhc29ucywgdGhlIEFwcHJvcHJpYXRlIExlZ2FsIE5vdGljZXMgbXVzdCBkaXNwbGF5XG4gKiB0aGUgd29yZHMgXCJTdXBlcmNoYXJnZWQgYnkgU3VpdGVDUk1cIi5cbiAqL1xuXG5pbXBvcnQge1NlYXJjaENyaXRlcmlhRmllbGRGaWx0ZXJ9IGZyb20gJy4uL3ZpZXdzL2xpc3Qvc2VhcmNoLWNyaXRlcmlhLm1vZGVsJztcbmltcG9ydCB7QmVoYXZpb3JTdWJqZWN0LCBPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcbmltcG9ydCB7QXN5bmNWYWxpZGF0b3JGbiwgVW50eXBlZEZvcm1BcnJheSwgVW50eXBlZEZvcm1Db250cm9sLCBWYWxpZGF0b3JGbn0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHtSZWNvcmR9IGZyb20gJy4vcmVjb3JkLm1vZGVsJztcbmltcG9ydCB7RmllbGRMb2dpY01hcH0gZnJvbSAnLi4vYWN0aW9ucy9maWVsZC1sb2dpYy1hY3Rpb24ubW9kZWwnO1xuaW1wb3J0IHtPYmplY3RNYXB9IGZyb20gJy4uL3R5cGVzL29iamVjdC1tYXAnO1xuaW1wb3J0IHtWaWV3TW9kZX0gZnJvbSAnLi4vdmlld3Mvdmlldy5tb2RlbCc7XG5pbXBvcnQge3NpZ25hbCwgV3JpdGFibGVTaWduYWx9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbmV4cG9ydCB0eXBlIERpc3BsYXlUeXBlID0gJ25vbmUnIHwgJ3Nob3cnIHwgJ3JlYWRvbmx5JyB8ICdpbmxpbmUnIHwgJ2Rpc2FibGVkJyB8ICdkZWZhdWx0JztcblxuZXhwb3J0IGludGVyZmFjZSBPcHRpb24ge1xuICAgIHZhbHVlOiBzdHJpbmc7XG4gICAgbGFiZWw/OiBzdHJpbmc7XG4gICAgbGFiZWxLZXk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvbkRlZmluaXRpb24ge1xuICAgIFtrZXk6IHN0cmluZ106IG51bWJlciB8IHN0cmluZztcblxuICAgIHR5cGU6IHN0cmluZztcbiAgICBtaW4/OiBudW1iZXIgfCBzdHJpbmc7XG4gICAgbWF4PzogbnVtYmVyIHwgc3RyaW5nO1xuICAgIGNvbXBhcmV0bz86IHN0cmluZztcbiAgICBibGFuaz86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZERlZmluaXRpb25NYXAge1xuICAgIFtrZXk6IHN0cmluZ106IEZpZWxkRGVmaW5pdGlvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZERlZmluaXRpb24ge1xuICAgIG5hbWU/OiBzdHJpbmc7XG4gICAgdHlwZT86IHN0cmluZzsgLy8gbGFiZWwga2V5IHRvIHVzZVxuICAgIHZuYW1lPzogc3RyaW5nOyAvLyBvcmlnaW5hbCBsYWJlbFxuICAgIGR5bmFtaWNMYWJlbEtleT86IHN0cmluZztcbiAgICBvcHRpb25zPzogc3RyaW5nO1xuICAgIHJlcG9ydGFibGU/OiBib29sZWFuO1xuICAgIHJlcXVpcmVkPzogYm9vbGVhbjtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgZHVwbGljYXRlX21lcmdlPzogc3RyaW5nO1xuICAgIHNvdXJjZT86IHN0cmluZztcbiAgICBpZD86IHN0cmluZztcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgaWRfbmFtZT86IHN0cmluZztcbiAgICBsaW5rPzogc3RyaW5nO1xuICAgIG1vZHVsZT86IHN0cmluZztcbiAgICB0eXBlX25hbWU/OiBzdHJpbmc7XG4gICAgcm5hbWU/OiBzdHJpbmc7XG4gICAgdGFibGU/OiBzdHJpbmc7XG4gICAgcmVhZG9ubHk/OiBib29sZWFuO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgICBpbmxpbmVfZWRpdD86IGJvb2xlYW47XG4gICAgdmFsaWRhdGlvbj86IFZhbGlkYXRpb25EZWZpbml0aW9uO1xuICAgIHZhbGlkYXRpb25zPzogVmFsaWRhdGlvbkRlZmluaXRpb25bXTtcbiAgICB0ZW1wbGF0ZT86IHN0cmluZztcbiAgICBkaXNwbGF5Pzogc3RyaW5nO1xuICAgIGRpc3BsYXlUeXBlPzogc3RyaW5nO1xuICAgIGRpc3BsYXlEaXJlY3Rpb24/OiBzdHJpbmc7XG4gICAgbGF5b3V0Pzogc3RyaW5nW107XG4gICAgc2hvd0xhYmVsPzogYW55O1xuICAgIGdyb3VwRmllbGRzPzogRmllbGREZWZpbml0aW9uTWFwO1xuICAgIGF0dHJpYnV0ZUZpZWxkcz86IEZpZWxkRGVmaW5pdGlvbk1hcDtcbiAgICB2YWx1ZVBhdGg/OiBzdHJpbmc7XG4gICAgdmFsdWVQYXJlbnQ/OiBzdHJpbmc7XG4gICAgZHluYW1pYz86IGJvb2xlYW47XG4gICAgcGFyZW50ZW51bT86IHN0cmluZztcbiAgICBsb2dpYz86IEZpZWxkTG9naWNNYXA7XG4gICAgZGlzcGxheUxvZ2ljPzogRmllbGRMb2dpY01hcDtcbiAgICBsaW5lSXRlbXM/OiBMaW5lSXRlbXNNZXRhZGF0YTtcbiAgICBtZXRhZGF0YT86IEZpZWxkTWV0YWRhdGE7XG4gICAgZGVmYXVsdD86IHN0cmluZztcbiAgICBkZWZhdWx0VmFsdWVNb2Rlcz86IFZpZXdNb2RlW107XG4gICAgbW9kZXM/OiBWaWV3TW9kZVtdO1xuICAgIHJlbGF0aW9uc2hpcD86IHN0cmluZztcbiAgICByZWxhdGlvbnNoaXBNZXRhZGF0YT86IFJlbGF0aW9uc2hpcE1ldGFkYXRhO1xuICAgIHVzZUZ1bGxDb2x1bW4/OiBzdHJpbmdbXTtcblxuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZWxhdGlvbnNoaXBNZXRhZGF0YSB7XG4gICAgc2lkZTogc3RyaW5nO1xuICAgIHJlbGF0ZWRfaWQ/OiBzdHJpbmc7XG4gICAgdHlwZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpbmVJdGVtc01ldGFkYXRhIHtcbiAgICBkZWZpbml0aW9uOiBGaWVsZERlZmluaXRpb247XG4gICAgbGFiZWxPbkZpcnN0TGluZT86IGJvb2xlYW47XG5cbiAgICBba2V5OiBzdHJpbmddOiBhbnk7XG59XG5cbmV4cG9ydCBkZWNsYXJlIHR5cGUgRmllbGRDbGlja0NhbGxiYWNrID0gKGZpZWxkOiBGaWVsZCwgcmVjb3JkOiBSZWNvcmQpID0+IHZvaWQ7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGRNZXRhZGF0YSB7XG4gICAgZm9ybWF0PzogYm9vbGVhbjtcbiAgICB0YXJnZXQ/OiBzdHJpbmc7XG4gICAgbGluaz86IGJvb2xlYW47XG4gICAgbGlua1JvdXRlPzogc3RyaW5nO1xuICAgIGxpbmtBc3luY0FjdGlvbj86IHN0cmluZztcbiAgICByb3dzPzogbnVtYmVyO1xuICAgIGNvbHM/OiBudW1iZXI7XG4gICAgZGlnaXRzPzogbnVtYmVyO1xuICAgIGlzQmFzZUN1cnJlbmN5PzogYm9vbGVhbjtcbiAgICBsYWJlbERpc3BsYXk/OiBzdHJpbmc7XG4gICAgb3B0aW9ucyQ/OiBPYnNlcnZhYmxlPE9wdGlvbltdPjtcbiAgICBleHRyYU9wdGlvbnM/OiBPcHRpb25bXTtcbiAgICBvbkNsaWNrPzogRmllbGRDbGlja0NhbGxiYWNrO1xuICAgIHRpbnltY2U/OiBhbnk7XG4gICAgdHJ1c3RIVE1MPzogYm9vbGVhbjtcbiAgICBkYXRlX3RpbWVfZm9ybWF0Pzogc3RyaW5nO1xuICAgIGRpc3BsYXlMb2dpY1Jlc2V0T24/OiBzdHJpbmc7XG4gICAgcmVsYXRlU2VhcmNoRmllbGQ/OiBzdHJpbmc7XG5cblxuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZEF0dHJpYnV0ZU1hcCB7XG4gICAgW2tleTogc3RyaW5nXTogRmllbGRBdHRyaWJ1dGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGRBdHRyaWJ1dGUgZXh0ZW5kcyBGaWVsZCB7XG4gICAgdmFsdWVQYXRoPzogc3RyaW5nO1xuICAgIHZhbHVlUGFyZW50Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkTWFwIHtcbiAgICBba2V5OiBzdHJpbmddOiBGaWVsZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBdHRyaWJ1dGVEZXBlbmRlbmN5IHtcbiAgICBmaWVsZDogc3RyaW5nO1xuICAgIGF0dHJpYnV0ZTogc3RyaW5nO1xuICAgIHR5cGVzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IHR5cGUgRmllbGRTb3VyY2UgPSAnZmllbGQnIHwgJ2F0dHJpYnV0ZScgfCAnaXRlbScgfCAnZ3JvdXBGaWVsZCc7XG5cbmV4cG9ydCBkZWNsYXJlIHR5cGUgRGVmYXVsdFZhbHVlSW5pdENhbGxiYWNrID0gKCkgPT4gdm9pZDtcblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZCB7XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIHZhbHVlPzogc3RyaW5nO1xuICAgIHZhbHVlTGlzdD86IHN0cmluZ1tdO1xuICAgIHZhbHVlT2JqZWN0PzogYW55O1xuICAgIHZhbHVlT2JqZWN0QXJyYXk/OiBPYmplY3RNYXBbXTtcbiAgICBuYW1lPzogc3RyaW5nO1xuICAgIHZhcmRlZkJhc2VkPzogYm9vbGVhbjtcbiAgICBsYWJlbD86IHN0cmluZztcbiAgICBsYWJlbEtleT86IHN0cmluZztcbiAgICBsb2FkaW5nPzogV3JpdGFibGVTaWduYWw8Ym9vbGVhbj47XG4gICAgZHluYW1pY0xhYmVsS2V5Pzogc3RyaW5nO1xuICAgIHBhcmVudEtleT86IHN0cmluZztcbiAgICBhdHRyaWJ1dGVzPzogRmllbGRBdHRyaWJ1dGVNYXA7XG4gICAgaXRlbXM/OiBSZWNvcmRbXTtcbiAgICByZWFkb25seT86IGJvb2xlYW47XG4gICAgZGlzcGxheT86IFdyaXRhYmxlU2lnbmFsPERpc3BsYXlUeXBlPjtcbiAgICByZXF1aXJlZD86IFdyaXRhYmxlU2lnbmFsPGJvb2xlYW4+O1xuICAgIGRlZmF1bHREaXNwbGF5Pzogc3RyaW5nO1xuICAgIGRlZmF1bHQ/OiBzdHJpbmc7XG4gICAgZGVmYXVsdFZhbHVlTW9kZXM/OiBWaWV3TW9kZVtdO1xuICAgIHNvdXJjZT86IEZpZWxkU291cmNlO1xuICAgIHZhbHVlU291cmNlPzogJ3ZhbHVlJyB8ICd2YWx1ZUxpc3QnIHwgJ3ZhbHVlT2JqZWN0JyB8ICdjcml0ZXJpYSc7XG4gICAgbWV0YWRhdGE/OiBGaWVsZE1ldGFkYXRhO1xuICAgIGRlZmluaXRpb24/OiBGaWVsZERlZmluaXRpb247XG4gICAgY3JpdGVyaWE/OiBTZWFyY2hDcml0ZXJpYUZpZWxkRmlsdGVyO1xuICAgIGZvcm1Db250cm9sPzogVW50eXBlZEZvcm1Db250cm9sO1xuICAgIGl0ZW1Gb3JtQXJyYXk/OiBVbnR5cGVkRm9ybUFycmF5O1xuICAgIHZhbGlkYXRvcnM/OiBWYWxpZGF0b3JGbltdO1xuICAgIGFzeW5jVmFsaWRhdG9ycz86IEFzeW5jVmFsaWRhdG9yRm5bXTtcbiAgICBpdGVtRm9ybUFycmF5U2F2ZVZhbGlkYXRvcnM/OiBWYWxpZGF0b3JGbltdO1xuICAgIHZhbHVlU3ViamVjdD86IEJlaGF2aW9yU3ViamVjdDxGaWVsZFZhbHVlPjtcbiAgICB2YWx1ZUNoYW5nZXMkPzogT2JzZXJ2YWJsZTxGaWVsZFZhbHVlPjtcbiAgICBmaWVsZERlcGVuZGVuY2llcz86IE9iamVjdE1hcDtcbiAgICBhdHRyaWJ1dGVEZXBlbmRlbmNpZXM/OiBBdHRyaWJ1dGVEZXBlbmRlbmN5W107XG4gICAgbG9naWM/OiBGaWVsZExvZ2ljTWFwO1xuICAgIGRpc3BsYXlMb2dpYz86IEZpZWxkTG9naWNNYXA7XG4gICAgcHJldmlvdXNWYWx1ZT86IHN0cmluZztcbiAgICB1c2VGdWxsQ29sdW1uPzogc3RyaW5nW107XG5cbiAgICBpbml0RGVmYXVsdFZhbHVlPzogRGVmYXVsdFZhbHVlSW5pdENhbGxiYWNrO1xufVxuXG5leHBvcnQgY2xhc3MgQmFzZUZpZWxkIGltcGxlbWVudHMgRmllbGQge1xuICAgIHR5cGU6IHN0cmluZztcbiAgICBuYW1lPzogc3RyaW5nO1xuICAgIHZhcmRlZkJhc2VkPzogYm9vbGVhbjtcbiAgICBsYWJlbD86IHN0cmluZztcbiAgICBsYWJlbEtleT86IHN0cmluZztcbiAgICBsb2FkaW5nPzogV3JpdGFibGVTaWduYWw8Ym9vbGVhbj4gPSBzaWduYWwoZmFsc2UpO1xuICAgIGR5bmFtaWNMYWJlbEtleT86IHN0cmluZztcbiAgICByZWFkb25seT86IGJvb2xlYW47XG4gICAgZGlzcGxheT86IFdyaXRhYmxlU2lnbmFsPERpc3BsYXlUeXBlPjtcbiAgICByZXF1aXJlZD86IFdyaXRhYmxlU2lnbmFsPGJvb2xlYW4+O1xuICAgIGRlZmF1bHREaXNwbGF5Pzogc3RyaW5nO1xuICAgIGRlZmF1bHQ/OiBzdHJpbmc7XG4gICAgZGVmYXVsdFZhbHVlTW9kZXM/OiBWaWV3TW9kZVtdO1xuICAgIHNvdXJjZT86IEZpZWxkU291cmNlO1xuICAgIG1ldGFkYXRhPzogRmllbGRNZXRhZGF0YTtcbiAgICBkZWZpbml0aW9uPzogRmllbGREZWZpbml0aW9uO1xuICAgIGNyaXRlcmlhPzogU2VhcmNoQ3JpdGVyaWFGaWVsZEZpbHRlcjtcbiAgICBmb3JtQ29udHJvbD86IFVudHlwZWRGb3JtQ29udHJvbDtcbiAgICBpdGVtRm9ybUFycmF5PzogVW50eXBlZEZvcm1BcnJheTtcbiAgICB2YWxpZGF0b3JzPzogVmFsaWRhdG9yRm5bXTtcbiAgICBpdGVtRm9ybUFycmF5U2F2ZVZhbGlkYXRvcnM/OiBWYWxpZGF0b3JGbltdO1xuICAgIGFzeW5jVmFsaWRhdG9ycz86IEFzeW5jVmFsaWRhdG9yRm5bXTtcbiAgICBhdHRyaWJ1dGVzPzogRmllbGRBdHRyaWJ1dGVNYXA7XG4gICAgdmFsdWVTdWJqZWN0PzogQmVoYXZpb3JTdWJqZWN0PEZpZWxkVmFsdWU+O1xuICAgIHZhbHVlQ2hhbmdlcyQ/OiBPYnNlcnZhYmxlPEZpZWxkVmFsdWU+O1xuICAgIGZpZWxkRGVwZW5kZW5jaWVzOiBPYmplY3RNYXAgPSB7fTtcbiAgICBhdHRyaWJ1dGVEZXBlbmRlbmNpZXM6IEF0dHJpYnV0ZURlcGVuZGVuY3lbXSA9IFtdO1xuICAgIGxvZ2ljPzogRmllbGRMb2dpY01hcDtcbiAgICBkaXNwbGF5TG9naWM/OiBGaWVsZExvZ2ljTWFwO1xuICAgIHVzZUZ1bGxDb2x1bW4/OiBzdHJpbmdbXTtcblxuICAgIHByb3RlY3RlZCB2YWx1ZVN0YXRlPzogc3RyaW5nO1xuICAgIHByb3RlY3RlZCB2YWx1ZUxpc3RTdGF0ZT86IHN0cmluZ1tdO1xuICAgIHByb3RlY3RlZCB2YWx1ZU9iamVjdFN0YXRlPzogYW55O1xuICAgIHByb3RlY3RlZCB2YWx1ZU9iamVjdEFycmF5U3RhdGU/OiBPYmplY3RNYXBbXTtcbiAgICBkZWZhdWx0VmFsdWVJbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudmFsdWVTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxGaWVsZFZhbHVlPih7fSBhcyBGaWVsZFZhbHVlKTtcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZXMkID0gdGhpcy52YWx1ZVN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XG4gICAgICAgIHRoaXMuZGlzcGxheSA9IHNpZ25hbCgnZGVmYXVsdCcpO1xuICAgICAgICB0aGlzLnJlcXVpcmVkID0gc2lnbmFsKGZhbHNlKTtcbiAgICB9XG5cbiAgICBnZXQgdmFsdWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVTdGF0ZTtcbiAgICB9XG5cbiAgICBzZXQgdmFsdWUodmFsdWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBjaGFuZ2VkID0gdmFsdWUgIT09IHRoaXMudmFsdWVTdGF0ZTtcblxuICAgICAgICB0aGlzLnZhbHVlU3RhdGUgPSB2YWx1ZTtcblxuICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2VzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgdmFsdWVMaXN0KCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVMaXN0U3RhdGU7XG4gICAgfVxuXG4gICAgc2V0IHZhbHVlTGlzdCh2YWx1ZTogc3RyaW5nW10pIHtcblxuICAgICAgICB0aGlzLnZhbHVlTGlzdFN0YXRlID0gdmFsdWU7XG5cbiAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2VzKCk7XG4gICAgfVxuXG4gICAgZ2V0IHZhbHVlT2JqZWN0KCk6IGFueSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlT2JqZWN0U3RhdGU7XG4gICAgfVxuXG4gICAgc2V0IHZhbHVlT2JqZWN0KHZhbHVlOiBhbnkpIHtcbiAgICAgICAgdGhpcy52YWx1ZU9iamVjdFN0YXRlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuZW1pdFZhbHVlQ2hhbmdlcygpO1xuICAgIH1cblxuICAgIGdldCB2YWx1ZU9iamVjdEFycmF5KCk6IGFueSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlT2JqZWN0QXJyYXlTdGF0ZTtcbiAgICB9XG5cbiAgICBzZXQgdmFsdWVPYmplY3RBcnJheSh2YWx1ZTogT2JqZWN0TWFwW10pIHtcbiAgICAgICAgdGhpcy52YWx1ZU9iamVjdEFycmF5U3RhdGUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2VzKCk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGVtaXRWYWx1ZUNoYW5nZXMoKSB7XG4gICAgICAgIHRoaXMudmFsdWVTdWJqZWN0Lm5leHQoe1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVTdGF0ZSxcbiAgICAgICAgICAgIHZhbHVlTGlzdDogdGhpcy52YWx1ZUxpc3RTdGF0ZSxcbiAgICAgICAgICAgIHZhbHVlT2JqZWN0OiB0aGlzLnZhbHVlT2JqZWN0U3RhdGVcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBpbml0RGVmYXVsdFZhbHVlKCk6IHZvaWQge1xuXG4gICAgICAgIGlmICh0aGlzLmRlZmF1bHRWYWx1ZUluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSB0aGlzPy5kZWZhdWx0ID8/IHRoaXM/LmRlZmluaXRpb24/LmRlZmF1bHQgPz8gbnVsbDtcbiAgICAgICAgaWYgKCF0aGlzLnZhbHVlICYmIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHRoaXM/LmZvcm1Db250cm9sPy5zZXRWYWx1ZShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWVJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy52YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGRWYWx1ZSB7XG4gICAgdmFsdWU/OiBzdHJpbmc7XG4gICAgdmFsdWVMaXN0Pzogc3RyaW5nW107XG4gICAgdmFsdWVPYmplY3Q/OiBhbnk7XG59XG5cblxuIl19